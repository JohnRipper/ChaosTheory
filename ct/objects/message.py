from dataclasses import dataclass, field
from typing import List, Optional

from ct.objects.attachment import Attachment
from ct.objects.channel import Channel
from ct.objects.discord_object import DiscordObject
from ct.objects.embed import Embed
from ct.objects.guild_member import GuildMember
from ct.objects.message_activity import MessageActivity
from ct.objects.message_application import MessageApplication
from ct.objects.message_reference import MessageReference
from ct.objects.reaction import Reaction
from ct.objects.role import Role
from ct.objects.user import User


@dataclass
class Message(DiscordObject):
    id: int  # id of the message

    channel_id: int  # id of the channel the message was sent in
    author: User  # the author of this message (not guaranteed to be a valid user)
    mentions: List[
        User]  # users specifically mentioned in the message |array of user objects, with an additional partial member field
    attachments: List[Attachment]  # any attached files
    embeds: List[Embed]  # any embedded content
    timestamp: str  # when this message was sent
    edited_timestamp: str  # when this message was edited (or null if never)
    content: str = ""  # contents of the message
    tts: bool = False  # whether this was a TTS message

    mention_channels: List[Channel] = field(default_factory=list)  # channels specifically mentioned in this message
    mention_roles: List[Role] = field(default_factory=list)  # roles specifically mentioned in this message
    reactions: List[Reaction] = field(default_factory=list)  # reactions to the message
    mention_everyone: bool = False  # whether this message mentions everyone
    webhook_id: Optional[int] = None  # if the message is generated by a webhook, this is the webhook's id
    nonce: Optional[str] = None  # used for validating a message was sent
    activity: Optional[MessageActivity] = None  # sent with Rich Presence-related chat embeds
    application: Optional[MessageApplication] = None  # sent with Rich Presence-related chat embeds
    message_reference: Optional[MessageReference] = None  # reference data sent with crossposted messages
    guild_id: Optional[int] = None  # id of the guild the message was sent in
    member: Optional[GuildMember] = None  # member properties for this message's author

    pinned: bool = False  # whether this message is pinned
    type: int = -1  # type of message
    flags: Optional[int] = -1  #

